import React from 'react';
import {TextBoxProps as Props} from './TextBox.interface';

import {TextBox as TB} from '../../../../Components/TextBox';
import {useAppDispatch, useAppSelector} from '../../StoreProvider';
import {Action, Selector} from '../../Store';

import cn from './TextBox.module.scss';

export function TextBox(props: Props) {
  const dispatch = useAppDispatch();

  const isPreview = useAppSelector(Selector.getIsPreview);

  const selectedPath = useAppSelector(Selector.getSelectedNodePath);

  const className = `${props.className} ${cn.viewOnly}`;

  const onClick = (e: React.MouseEvent) => {
    e.stopPropagation();
    dispatch(Action.selectComponent(props.path));
  };

  const wrapClass = `${cn.opt} ${
    props.path === selectedPath ? cn.selected : ''
  }`;

  const component = (
    <TB
      id={props.id}
      label={props.label}
      name={props.name}
      pattern={props.pattern}
      className={className}
      required={props.required}
      minLength={props.minLength}
      maxLength={props.maxLength}
      invalidInputMessage={props.invalidInputMessage}
      isSubmitted={props.isSubmitted}
      disabled={props.disabled}
      placeholder={props.placeholder}
    />
  );

  if (isPreview) {
    return component;
  } else {
    return (
      <div className={wrapClass} onClick={onClick}>
        {component}
      </div>
    );
  }
}

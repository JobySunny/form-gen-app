import React from 'react';
import {AddNewProps as Props} from './AddNew.interface';

import {DD_KEY} from '../../ChooseComponent/ComponentOption/ComponentOption';
import {useAppDispatch} from '../../StoreProvider';
import {addToCanvas} from '../../Store/Store.actions';

import cn from './AddNew.module.scss';

export function AddNew(props: Props) {
  const dispatch = useAppDispatch();

  const [over, s] = React.useState(false);

  const setOver = (boolValue: boolean) => () => {
    s(boolValue);
  };

  const onDrop = (event: React.DragEvent) => {
    const pathId = event.dataTransfer.getData(DD_KEY);
    setOver(false)();
    dispatch(addToCanvas({pathId, placePath: props.path}));
  };

  const onDragOver = (e: React.DragEvent) => {
    e.preventDefault();
  };

  const getClassName = () => `${cn.addnew} ${over ? cn.dragging : ''}`;

  return (
    <div
      onDrop={onDrop}
      className={getClassName()}
      aria-label={props.path}
      onDragOver={onDragOver}
      onDragEnter={setOver(true)}
      onDragLeave={setOver(false)}>
      + Drop Here
    </div>
  );
}

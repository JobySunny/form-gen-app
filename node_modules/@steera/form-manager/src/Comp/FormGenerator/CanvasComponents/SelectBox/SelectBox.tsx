import React from 'react';
import {SelectBoxProps as Props} from './SelectBox.interface';
import {
  SelectBox as SB,
  SelectBoxProps as SBP,
} from '../../../../Components/SelectBox';
import {useAppDispatch, useAppSelector} from '../../StoreProvider';
import {Action, Selector} from '../../Store';

import cn from './SelectBox.module.scss';

export function SelectBox(props: Props) {
  const dispatch = useAppDispatch();

  const isPreview = useAppSelector(Selector.getIsPreview);

  const selectedPath = useAppSelector(Selector.getSelectedNodePath);

  const onClick = (e: React.MouseEvent) => {
    e.stopPropagation();
    dispatch(Action.selectComponent(props.path));
  };

  const wrapClass = `${cn.opt} ${
    props.path === selectedPath ? cn.selected : ''
  }`;

  const className = `${props.className} ${cn.viewOnly}`;

  const onChange: SBP['onChange'] = (e) => {};

  const component = (
    <SB
      id={props.id}
      label={props.label}
      name={props.name}
      onChange={onChange}
      className={className}
      options={props.options}
      required={props.required}
      disabled={props.disabled}
      placeholder={props.placeholder}
      invalidInputMessage={props.invalidInputMessage}
    />
  );

  if (isPreview) {
    return component;
  } else {
    return (
      <div className={wrapClass} onClick={onClick}>
        {component}
      </div>
    );
  }
}
